<?php

namespace laf\Detection;

$opensslciphername["None"] = 	"TLS_NULL_WITH_NULL_NULL";
$opensslciphername["NULL-MD5"] = "TLS_RSA_WITH_NULL_MD5";
$opensslciphername["NULL-SHA"] = "TLS_RSA_WITH_NULL_SHA";
$opensslciphername["EXP-RC4-MD5"] = "TLS_RSA_EXPORT_WITH_RC4_40_MD5";
$opensslciphername["RC4-MD5"] = "TLS_RSA_WITH_RC4_128_MD5";
$opensslciphername["RC4-SHA"] = "TLS_RSA_WITH_RC4_128_SHA";
$opensslciphername["EXP-RC2-CBC-MD5"] = "TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5";
$opensslciphername["IDEA-CBC-SHA"] = "TLS_RSA_WITH_IDEA_CBC_SHA";
$opensslciphername["EXP-DES-CBC-SHA"] = "TLS_RSA_EXPORT_WITH_DES40_CBC_SHA";
$opensslciphername["DES-CBC-SHA"] = "TLS_RSA_WITH_DES_CBC_SHA";
$opensslciphername["DES-CBC3-SHA"] = "TLS_RSA_WITH_3DES_EDE_CBC_SHA";
$opensslciphername["EXP-DH-DSS-DES-CBC-SHA"] = "TLS_DH_DSS_EXPORT_WITH_DES40_CBC_SHA";
$opensslciphername["DH-DSS-DES-CBC-SHA"] = "TLS_DH_DSS_WITH_DES_CBC_SHA";
$opensslciphername["DH-DSS-DES-CBC3-SHA"] = "TLS_DH_DSS_WITH_3DES_EDE_CBC_SHA";
$opensslciphername["EXP-DH-RSA-DES-CBC-SHA"] = "TLS_DH_RSA_EXPORT_WITH_DES40_CBC_SHA";
$opensslciphername["DH-RSA-DES-CBC-SHA"] = "TLS_DH_RSA_WITH_DES_CBC_SHA";
$opensslciphername["DH-RSA-DES-CBC3-SHA"] = "TLS_DH_RSA_WITH_3DES_EDE_CBC_SHA";
$opensslciphername["EXP-EDH-DSS-DES-CBC-SHA"] = "TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA";
$opensslciphername["EDH-DSS-DES-CBC-SHA"] = "TLS_DHE_DSS_WITH_DES_CBC_SHA";
$opensslciphername["EDH-DSS-DES-CBC3-SHA"] = "TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA";
$opensslciphername["EXP-EDH-RSA-DES-CBC-SHA"] = "TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA";
$opensslciphername["EDH-RSA-DES-CBC-SHA"] = "TLS_DHE_RSA_WITH_DES_CBC_SHA";
$opensslciphername["EDH-RSA-DES-CBC3-SHA"] = "TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA";
$opensslciphername["EXP-ADH-RC4-MD5"] = "TLS_DH_anon_EXPORT_WITH_RC4_40_MD5";
$opensslciphername["ADH-RC4-MD5"] = "TLS_DH_anon_WITH_RC4_128_MD5";
$opensslciphername["EXP-ADH-DES-CBC-SHA"] = "TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA";
$opensslciphername["ADH-DES-CBC-SHA"] = "TLS_DH_anon_WITH_DES_CBC_SHA";
$opensslciphername["ADH-DES-CBC3-SHA"] = "TLS_DH_anon_WITH_3DES_EDE_CBC_SHA";
$opensslciphername["KRB5-DES-CBC-SHA"] = "TLS_KRB5_WITH_DES_CBC_SHA";
$opensslciphername["KRB5-DES-CBC3-SHA"] = "TLS_KRB5_WITH_3DES_EDE_CBC_SHA";
$opensslciphername["KRB5-RC4-SHA"] = "TLS_KRB5_WITH_RC4_128_SHA";
$opensslciphername["KRB5-IDEA-CBC-SHA"] = "TLS_KRB5_WITH_IDEA_CBC_SHA";
$opensslciphername["KRB5-DES-CBC-MD5"] = "TLS_KRB5_WITH_DES_CBC_MD5";
$opensslciphername["KRB5-DES-CBC3-MD5"] = "TLS_KRB5_WITH_3DES_EDE_CBC_MD5";
$opensslciphername["KRB5-RC4-MD5"] = "TLS_KRB5_WITH_RC4_128_MD5";
$opensslciphername["KRB5-IDEA-CBC-MD5"] = "TLS_KRB5_WITH_IDEA_CBC_MD5";
$opensslciphername["EXP-KRB5-DES-CBC-SHA"] = "TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA";
$opensslciphername["EXP-KRB5-RC2-CBC-SHA"] = "TLS_KRB5_EXPORT_WITH_RC2_CBC_40_SHA";
$opensslciphername["EXP-KRB5-RC4-SHA 	KRB5"] = "TLS_KRB5_EXPORT_WITH_RC4_40_SHA";
$opensslciphername["EXP-KRB5-DES-CBC-MD5"] = "TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5";
$opensslciphername["EXP-KRB5-RC2-CBC-MD5"] = "TLS_KRB5_EXPORT_WITH_RC2_CBC_40_MD5";
$opensslciphername["EXP-KRB5-RC4-MD5"] = "TLS_KRB5_EXPORT_WITH_RC4_40_MD5";
$opensslciphername["PSK-NULL-SHA"] = "TLS_PSK_WITH_NULL_SHA";
$opensslciphername["DHE-PSK-NULL-SHA"] = "TLS_DHE_PSK_WITH_NULL_SHA";
$opensslciphername["RSA-PSK-NULL-SHA"] = "TLS_RSA_PSK_WITH_NULL_SHA";
$opensslciphername["AES128-SHA"] = "TLS_RSA_WITH_AES_128_CBC_SHA";
$opensslciphername["DH-DSS-AES128-SHA"] = "TLS_DH_DSS_WITH_AES_128_CBC_SHA";
$opensslciphername["DH-RSA-AES128-SHA"] = "TLS_DH_RSA_WITH_AES_128_CBC_SHA";
$opensslciphername["DHE-DSS-AES128-SHA"] = "TLS_DHE_DSS_WITH_AES_128_CBC_SHA";
$opensslciphername["DHE-RSA-AES128-SHA"] = "TLS_DHE_RSA_WITH_AES_128_CBC_SHA";
$opensslciphername["ADH-AES128-SHA"] = "TLS_DH_anon_WITH_AES_128_CBC_SHA";
$opensslciphername["AES256-SHA"] = "TLS_RSA_WITH_AES_256_CBC_SHA";
$opensslciphername["DH-DSS-AES256-SHA"] = "TLS_DH_DSS_WITH_AES_256_CBC_SHA";
$opensslciphername["DH-RSA-AES256-SHA"] = "TLS_DH_RSA_WITH_AES_256_CBC_SHA";
$opensslciphername["DHE-DSS-AES256-SHA"] = "TLS_DHE_DSS_WITH_AES_256_CBC_SHA";
$opensslciphername["DHE-RSA-AES256-SHA"] = "TLS_DHE_RSA_WITH_AES_256_CBC_SHA";
$opensslciphername["ADH-AES256-SHA"] = "TLS_DH_anon_WITH_AES_256_CBC_SHA";
$opensslciphername["NULL-SHA256"] = "TLS_RSA_WITH_NULL_SHA256";
$opensslciphername["AES128-SHA256"] = "TLS_RSA_WITH_AES_128_CBC_SHA256";
$opensslciphername["AES256-SHA256"] = "TLS_RSA_WITH_AES_256_CBC_SHA256";
$opensslciphername["DH-DSS-AES128-SHA256"] = "TLS_DH_DSS_WITH_AES_128_CBC_SHA256";
$opensslciphername["DH-RSA-AES128-SHA256"] = "TLS_DH_RSA_WITH_AES_128_CBC_SHA256";
$opensslciphername["DHE-DSS-AES128-SHA256"] = "TLS_DHE_DSS_WITH_AES_128_CBC_SHA256";
$opensslciphername["CAMELLIA128-SHA"] = "TLS_RSA_WITH_CAMELLIA_128_CBC_SHA";
$opensslciphername["DH-DSS-CAMELLIA128-SHA"] = "TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA";
$opensslciphername["DH-RSA-CAMELLIA128-SHA"] = "TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA";
$opensslciphername["DHE-DSS-CAMELLIA128-SHA"] = "TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA";
$opensslciphername["DHE-RSA-CAMELLIA128-SHA"] = "TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA";
$opensslciphername["ADH-CAMELLIA128-SHA"] = "TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA";
$opensslciphername["EXP1024-RC4-MD5"] = "TLS_RSA_EXPORT1024_WITH_RC4_56_MD5";
$opensslciphername["EXP1024-RC2-CBC-MD5"] = "TLS_RSA_EXPORT1024_WITH_RC2_CBC_56_MD5";
$opensslciphername["EXP1024-DES-CBC-SHA"] = "TLS_RSA_EXPORT1024_WITH_DES_CBC_SHA";
$opensslciphername["EXP1024-DHE-DSS-DES-CBC-SHA"] = "TLS_DHE_DSS_EXPORT1024_WITH_DES_CBC_SHA";
$opensslciphername["EXP1024-RC4-SHA"] = "TLS_RSA_EXPORT1024_WITH_RC4_56_SHA";
$opensslciphername["EXP1024-DHE-DSS-RC4-SHA"] = "TLS_DHE_DSS_EXPORT1024_WITH_RC4_56_SHA";
$opensslciphername["DHE-DSS-RC4-SHA"] = "TLS_DHE_DSS_WITH_RC4_128_SHA";
$opensslciphername["DHE-RSA-AES128-SHA256"] = "TLS_DHE_RSA_WITH_AES_128_CBC_SHA256";
$opensslciphername["DH-DSS-AES256-SHA256"] = "TLS_DH_DSS_WITH_AES_256_CBC_SHA256";
$opensslciphername["DH-RSA-AES256-SHA256"] = "TLS_DH_RSA_WITH_AES_256_CBC_SHA256";
$opensslciphername["DHE-DSS-AES256-SHA256"] = "TLS_DHE_DSS_WITH_AES_256_CBC_SHA256";
$opensslciphername["DHE-RSA-AES256-SHA256"] = "TLS_DHE_RSA_WITH_AES_256_CBC_SHA256";
$opensslciphername["ADH-AES128-SHA256"] = "TLS_DH_anon_WITH_AES_128_CBC_SHA256";
$opensslciphername["ADH-AES256-SHA256"] = "TLS_DH_anon_WITH_AES_256_CBC_SHA256";
$opensslciphername["GOST94-GOST89-GOST89"] = "TLS_GOSTR341094_WITH_28147_CNT_IMIT";
$opensslciphername["GOST2001-GOST89-GOST89"] = "TLS_GOSTR341001_WITH_28147_CNT_IMIT";
$opensslciphername["GOST94-NULL-GOST94"] = "TLS_GOSTR341001_WITH_NULL_GOSTR3411";
$opensslciphername["GOST2001-GOST89-GOST89"] = "TLS_GOSTR341094_WITH_NULL_GOSTR3411";
$opensslciphername["CAMELLIA256-SHA"] = "TLS_RSA_WITH_CAMELLIA_256_CBC_SHA";
$opensslciphername["DH-DSS-CAMELLIA256-SHA"] = "TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA";
$opensslciphername["DH-RSA-CAMELLIA256-SHA"] = "TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA";
$opensslciphername["DHE-DSS-CAMELLIA256-SHA"] = "TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA";
$opensslciphername["DHE-RSA-CAMELLIA256-SHA"] = "LS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA";
$opensslciphername["ADH-CAMELLIA256-SHA"] = "TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA";
$opensslciphername["PSK-RC4-SHA"] = "TLS_PSK_WITH_RC4_128_SHA";
$opensslciphername["PSK-3DES-EDE-CBC-SHA"] = "TLS_PSK_WITH_3DES_EDE_CBC_SHA";
$opensslciphername["PSK-AES128-CBC-SHA"] = "TLS_PSK_WITH_AES_128_CBC_SHA";
$opensslciphername["PSK-AES256-CBC-SHA"] = "TLS_PSK_WITH_AES_256_CBC_SHA";
$opensslciphername["SEED-SHA"] = "TLS_RSA_WITH_SEED_CBC_SHA";
$opensslciphername["DH-DSS-SEED-SHA"] = "TLS_DH_DSS_WITH_SEED_CBC_SHA";
$opensslciphername["DH-RSA-SEED-SHA"] = "TLS_DH_RSA_WITH_SEED_CBC_SHA";
$opensslciphername["DHE-DSS-SEED-SHA"] = "TLS_DHE_DSS_WITH_SEED_CBC_SHA";
$opensslciphername["DHE-RSA-SEED-SHA"] = "TLS_DHE_RSA_WITH_SEED_CBC_SHA";
$opensslciphername["ADH-SEED-SHA"] = "TLS_DH_anon_WITH_SEED_CBC_SHA";
$opensslciphername["AES128-GCM-SHA256"] = "TLS_RSA_WITH_AES_128_GCM_SHA256";
$opensslciphername["AES256-GCM-SHA384"] = "TLS_RSA_WITH_AES_256_GCM_SHA384";
$opensslciphername["DHE-RSA-AES128-GCM-SHA256"] = "TLS_DHE_RSA_WITH_AES_128_GCM_SHA256";
$opensslciphername["DHE-RSA-AES256-GCM-SHA384"] = "TLS_DHE_RSA_WITH_AES_256_GCM_SHA384";
$opensslciphername["DH-RSA-AES128-GCM-SHA256"] = "TLS_DH_RSA_WITH_AES_128_GCM_SHA256";
$opensslciphername["DH-RSA-AES256-GCM-SHA384"] = "TLS_DH_RSA_WITH_AES_256_GCM_SHA384";
$opensslciphername["DHE-DSS-AES128-GCM-SHA256"] = "TLS_DHE_DSS_WITH_AES_128_GCM_SHA256";
$opensslciphername["DHE-DSS-AES256-GCM-SHA384"] = "TLS_DHE_DSS_WITH_AES_256_GCM_SHA384";
$opensslciphername["DH-DSS-AES128-GCM-SHA256"] = "TLS_DH_DSS_WITH_AES_128_GCM_SHA256";
$opensslciphername["DH-DSS-AES256-GCM-SHA384"] = "TLS_DH_DSS_WITH_AES_256_GCM_SHA384";
$opensslciphername["ADH-AES128-GCM-SHA256"] = "TLS_DH_anon_WITH_AES_128_GCM_SHA256";
$opensslciphername["ADH-AES256-GCM-SHA384"] = "TLS_DH_anon_WITH_AES_256_GCM_SHA384";
$opensslciphername["CAMELLIA128-SHA256"] = "TLS_RSA_WITH_CAMELLIA_128_CBC_SHA256";
$opensslciphername["DH-DSS-CAMELLIA128-SHA256"] = "TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA256";
$opensslciphername["DH-RSA-CAMELLIA128-SHA256"] = "TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA256";
$opensslciphername["DHE-DSS-CAMELLIA128-SHA256"] = "TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA256";
$opensslciphername["DHE-RSA-CAMELLIA128-SHA256"] = "TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256";
$opensslciphername["ADH-CAMELLIA128-SHA256"] = "TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA256";
$opensslciphername["TLS_FALLBACK_SCSV"] = "TLS_EMPTY_RENEGOTIATION_INFO_SCSV";
$opensslciphername["TLS_AES_128_GCM_SHA256"] = "TLS_AES_128_GCM_SHA256";
$opensslciphername["TLS_AES_256_GCM_SHA384"] = "TLS_AES_256_GCM_SHA384";
$opensslciphername["TLS_CHACHA20_POLY1305_SHA256"] = "TLS_CHACHA20_POLY1305_SHA256";
$opensslciphername["TLS_AES_128_CCM_SHA256"] = "TLS_AES_128_CCM_SHA256";
$opensslciphername["TLS_AES_128_CCM_8_SHA256"] = "TLS_AES_128_CCM_8_SHA256";
$opensslciphername["ECDH-ECDSA-NULL-SHA"] = "TLS_ECDH_ECDSA_WITH_NULL_SHA";
$opensslciphername["ECDH-ECDSA-RC4-SHA"] = "TLS_ECDH_ECDSA_WITH_RC4_128_SHA";
$opensslciphername["ECDH-ECDSA-DES-CBC3-SHA"] = "TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA";
$opensslciphername["ECDH-ECDSA-AES128-SHA"] = "TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA";
$opensslciphername["ECDH-ECDSA-AES256-SHA"] = "TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA";
$opensslciphername["ECDHE-ECDSA-NULL-SHA"] = "TLS_ECDHE_ECDSA_WITH_NULL_SHA";
$opensslciphername["ECDHE-ECDSA-RC4-SHA"] = "TLS_ECDHE_ECDSA_WITH_RC4_128_SHA";
$opensslciphername["ECDHE-ECDSA-DES-CBC3-SHA"] = "TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA";
$opensslciphername["ECDHE-ECDSA-AES128-SHA"] = "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA";
$opensslciphername["ECDHE-ECDSA-AES256-SHA"] = "TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA";
$opensslciphername["ECDH-RSA-NULL-SHA"] = "TLS_ECDH_RSA_WITH_NULL_SHA";
$opensslciphername["ECDH-RSA-RC4-SHA"] = "TLS_ECDH_RSA_WITH_RC4_128_SHA";
$opensslciphername["ECDH-RSA-DES-CBC3-SHA"] = "TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA";
$opensslciphername["ECDH-RSA-AES128-SHA"] = "TLS_ECDH_RSA_WITH_AES_128_CBC_SHA";
$opensslciphername["ECDH-RSA-AES256-SHA"] = "TLS_ECDH_RSA_WITH_AES_256_CBC_SHA";
$opensslciphername["ECDHE-RSA-NULL-SHA"] = "TLS_ECDHE_RSA_WITH_NULL_SHA";
$opensslciphername["ECDHE-RSA-RC4-SHA"] = "TLS_ECDHE_RSA_WITH_RC4_128_SHA";
$opensslciphername["ECDHE-RSA-DES-CBC3-SHA"] = "TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA";
$opensslciphername["ECDHE-RSA-AES128-SHA"] = "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA";
$opensslciphername["ECDHE-RSA-AES256-SHA"] = "TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA";
$opensslciphername["AECDH-NULL-SHA"] = "TLS_ECDH_anon_WITH_NULL_SHA";
$opensslciphername["AECDH-RC4-SHA"] = "TLS_ECDH_anon_WITH_RC4_128_SHA";
$opensslciphername["AECDH-DES-CBC3-SHA"] = "TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA";
$opensslciphername["AECDH-AES128-SHA"] = "TLS_ECDH_anon_WITH_AES_128_CBC_SHA";
$opensslciphername["AECDH-AES256-SHA"] = "TLS_ECDH_anon_WITH_AES_256_CBC_SHA";
$opensslciphername["SRP-3DES-EDE-CBC-SHA"] = "TLS_SRP_SHA_WITH_3DES_EDE_CBC_SHA";
$opensslciphername["SRP-RSA-3DES-EDE-CBC-SHA"] = "TLS_SRP_SHA_RSA_WITH_3DES_EDE_CBC_SHA";
$opensslciphername["SRP-DSS-3DES-EDE-CBC-SHA"] = "TLS_SRP_SHA_DSS_WITH_3DES_EDE_CBC_SHA";
$opensslciphername["SRP-AES-128-CBC-SHA"] = "TLS_SRP_SHA_WITH_AES_128_CBC_SHA";
$opensslciphername["SRP-RSA-AES-128-CBC-SHA"] = "TLS_SRP_SHA_RSA_WITH_AES_128_CBC_SHA";
$opensslciphername["SRP-DSS-AES-128-CBC-SHA"] = "TLS_SRP_SHA_DSS_WITH_AES_128_CBC_SHA";
$opensslciphername["SRP-AES-256-CBC-SHA"] = "TLS_SRP_SHA_WITH_AES_256_CBC_SHA";
$opensslciphername["SRP-RSA-AES-256-CBC-SHA"] = "TLS_SRP_SHA_RSA_WITH_AES_256_CBC_SHA";
$opensslciphername["SRP-DSS-AES-256-CBC-SHA"] = "TLS_SRP_SHA_DSS_WITH_AES_256_CBC_SHA";
$opensslciphername["ECDHE-ECDSA-AES128-SHA256"] = "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256";
$opensslciphername["ECDHE-ECDSA-AES256-SHA384"] = "TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384";
$opensslciphername["ECDH-ECDSA-AES128-SHA256"] = "TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256";
$opensslciphername["ECDH-ECDSA-AES256-SHA384"] = "TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384";
$opensslciphername["ECDHE-RSA-AES128-SHA256"] = "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256";
$opensslciphername["ECDHE-RSA-AES256-SHA384"] = "TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384";
$opensslciphername["ECDH-RSA-AES128-SHA256"] = "TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256";
$opensslciphername["ECDH-RSA-AES256-SHA384"] = "TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384";
$opensslciphername["ECDHE-ECDSA-AES128-GCM-SHA256"] = "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256";
$opensslciphername["ECDHE-ECDSA-AES256-GCM-SHA384"] = "TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384";
$opensslciphername["ECDH-ECDSA-AES128-GCM-SHA256"] = "TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256";
$opensslciphername["ECDH-ECDSA-AES256-GCM-SHA384"] = "TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384";
$opensslciphername["ECDHE-RSA-AES128-GCM-SHA256"] = "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256";
$opensslciphername["ECDHE-RSA-AES256-GCM-SHA384"] = "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384";
$opensslciphername["ECDH-RSA-AES128-GCM-SHA256"] = "TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256";
$opensslciphername["ECDH-RSA-AES256-GCM-SHA384"] = "TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384";
$opensslciphername["ECDHE-PSK-RC4-SHA"] = "TLS_ECDHE_PSK_WITH_RC4_128_SHA";
$opensslciphername["ECDHE-PSK-3DES-EDE-CBC-SHA"] = "TLS_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA";
$opensslciphername["ECDHE-PSK-AES128-CBC-SHA"] = "TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA";
$opensslciphername["ECDHE-PSK-AES256-CBC-SHA"] = "TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA";
$opensslciphername["ECDHE-PSK-AES128-CBC-SHA256"] = "TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256";
$opensslciphername["ECDHE-PSK-AES256-CBC-SHA384"] = "TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384";
$opensslciphername["ECDHE-PSK-NULL-SHA"] = "TLS_ECDHE_PSK_WITH_NULL_SHA";
$opensslciphername["ECDHE-PSK-NULL-SHA256"] = "TLS_ECDHE_PSK_WITH_NULL_SHA256";
$opensslciphername["ECDHE-PSK-NULL-SHA384"] = "TLS_ECDHE_PSK_WITH_NULL_SHA384";
$opensslciphername["ECDHE-ECDSA-CAMELLIA128-SHA256"] = "TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256";
$opensslciphername["ECDHE-ECDSA-CAMELLIA256-SHA384"] = "TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384";
$opensslciphername["ECDH-ECDSA-CAMELLIA128-SHA256"] = "TLS_ECDH_ECDSA_WITH_CAMELLIA_128_CBC_SHA256";
$opensslciphername["ECDH-ECDSA-CAMELLIA256-SHA384"] = "TLS_ECDH_ECDSA_WITH_CAMELLIA_256_CBC_SHA384";
$opensslciphername["ECDHE-RSA-CAMELLIA128-SHA256"] = "TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256";
$opensslciphername["ECDHE-RSA-CAMELLIA256-SHA384"] = "TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384";
$opensslciphername["ECDH-RSA-CAMELLIA128-SHA256"] = "TLS_ECDH_RSA_WITH_CAMELLIA_128_CBC_SHA256";
$opensslciphername["ECDH-RSA-CAMELLIA256-SHA384"] = "TLS_ECDH_RSA_WITH_CAMELLIA_256_CBC_SHA384";
$opensslciphername["PSK-CAMELLIA128-SHA256"] = "TLS_PSK_WITH_CAMELLIA_128_CBC_SHA256";
$opensslciphername["PSK-CAMELLIA256-SHA384"] = "TLS_PSK_WITH_CAMELLIA_256_CBC_SHA384";
$opensslciphername["DHE-PSK-CAMELLIA128-SHA256"] = "TLS_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256";
$opensslciphername["DHE-PSK-CAMELLIA256-SHA384"] = "TLS_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384";
$opensslciphername["RSA-PSK-CAMELLIA128-SHA256"] = "TLS_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256";
$opensslciphername["RSA-PSK-CAMELLIA256-SHA384"] = "TLS_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384";
$opensslciphername["ECDHE-PSK-CAMELLIA128-SHA25"] = "TLS_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256";
$opensslciphername["ECDHE-PSK-CAMELLIA256-SHA38"] = "TLS_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384";
$opensslciphername["AES128-CCM"] = "TLS_RSA_WITH_AES_128_CCM";
$opensslciphername["AES256-CCM"] = "TLS_RSA_WITH_AES_256_CCM";
$opensslciphername["DHE-RSA-AES128-CCM"] = "TLS_DHE_RSA_WITH_AES_128_CCM";
$opensslciphername["DHE-RSA-AES256-CCM"] = "TLS_DHE_RSA_WITH_AES_256_CCM";
$opensslciphername["AES128-CCM8"] = "TLS_RSA_WITH_AES_128_CCM_8";
$opensslciphername["AES256-CCM8"] = "TLS_RSA_WITH_AES_256_CCM_8";
$opensslciphername["DHE-RSA-AES128-CCM8"] = "TLS_DHE_RSA_WITH_AES_128_CCM_8";
$opensslciphername["DHE-RSA-AES256-CCM8"] = "TLS_DHE_RSA_WITH_AES_256_CCM_8";
$opensslciphername["PSK-AES128-CCM"] = "TLS_PSK_WITH_AES_128_CCM";
$opensslciphername["PSK-AES256-CCM"] = "TLS_PSK_WITH_AES_256_CCM";
$opensslciphername["DHE-PSK-AES128-CCM"] = "TLS_DHE_PSK_WITH_AES_128_CCM";
$opensslciphername["DHE-PSK-AES256-CCM"] = "TLS_DHE_PSK_WITH_AES_256_CCM";
$opensslciphername["PSK-AES128-CCM8"] = "TLS_PSK_WITH_AES_128_CCM_8";
$opensslciphername["PSK-AES256-CCM8"] = "TLS_PSK_WITH_AES_256_CCM_8";
$opensslciphername["DHE-PSK-AES128-CCM8"] = "TLS_PSK_DHE_WITH_AES_128_CCM_8";
$opensslciphername["DHE-PSK-AES256-CCM8"] = "TLS_PSK_DHE_WITH_AES_256_CCM_8";
$opensslciphername["ECDHE-ECDSA-AES128-CCM"] = "TLS_ECDHE_ECDSA_WITH_AES_128_CCM";
$opensslciphername["ECDHE-ECDSA-AES256-CCM"] = "TLS_ECDHE_ECDSA_WITH_AES_256_CCM";
$opensslciphername["ECDHE-ECDSA-AES128-CCM8"] = "TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8";
$opensslciphername["ECDHE-ECDSA-AES256-CCM8"] = "TLS_ECDHE_ECDSA_WITH_AES_256_CCM_8";
$opensslciphername["ECDHE-RSA-CHACHA20-POLY1305"] = "TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256";
$opensslciphername["ECDHE-ECDSA-CHACHA20-POLY1305"] = "TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256";
$opensslciphername["DHE-RSA-CHACHA20-POLY1305"] = "TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256";
$opensslciphername["GOST-MD5"] = "TLS_GOSTR341094_RSA_WITH_28147_CNT_MD5";
$opensslciphername["GOST-GOST94"] = "TLS_RSA_WITH_28147_CNT_GOST94";
$opensslciphername["GOST-GOST89MAC"] = "GOST89";
$opensslciphername["GOST-GOST89STREAM"] = "GOST89";
$opensslciphername["RC4-MD"] = "SSL_CK_RC4_128_WITH_MD5";
$opensslciphername["EXP-RC4-MD5"] = "SSL_CK_RC4_128_EXPORT40_WITH_MD5";
$opensslciphername["RC2-CBC-MD5"] = "SSL_CK_RC2_128_CBC_WITH_MD5";
$opensslciphername["EXP-RC2-CBC-MD5"] = "SSL_CK_RC2_128_CBC_EXPORT40_WITH_MD5";
$opensslciphername["IDEA-CBC-MD5"] = "SSL_CK_IDEA_128_CBC_WITH_MD5";
$opensslciphername["DES-CBC-MD5"] = "SSL_CK_DES_64_CBC_WITH_MD5";
$opensslciphername["DES-CBC-SHA"] = "SSL_CK_DES_64_CBC_WITH_SHA";
$opensslciphername["DES-CBC3-MD5"] = "SSL_CK_DES_192_EDE3_CBC_WITH_MD5";
$opensslciphername["DES-CBC3-SHA"] = "SSL_CK_DES_192_EDE3_CBC_WITH_SHA";
$opensslciphername["RC4-64-MD5"] = "SSL_CK_RC4_64_WITH_MD5";
$opensslciphername["DES-CFB-M1"] = "SSL_CK_DES_64_CFB64_WITH_MD5_1";
$opensslciphername["NULL"] = "SSL_CK_NULL";

#https://wiki.mozilla.org/Security/Cipher_Suites
$opensslciphername["ECDHE-ECDSA-CHACHA20-POLY1305"] = "TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256";
$opensslciphername["ECDHE-RSA-CHACHA20-POLY1305"] = "TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256";
$opensslciphername["DHE-RSA-CHACHA20-POLY1305"] = "TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256";
$opensslciphername["RSA-PSK-AES256-GCM-SHA384"] = "TLS_RSA_PSK_WITH_AES_256_GCM_SHA384";
$opensslciphername["DHE-PSK-AES256-GCM-SHA384"] = "TLS_DHE_PSK_WITH_AES_256_GCM_SHA384";
$opensslciphername["RSA-PSK-CHACHA20-POLY1305"] = "TLS_RSA_PSK_WITH_CHACHA20_POLY1305_SHA256";
$opensslciphername["DHE-PSK-CHACHA20-POLY1305"] = "TLS_DHE_PSK_WITH_CHACHA20_POLY1305_SHA256";
$opensslciphername["ECDHE-PSK-CHACHA20-POLY1305"] = "TLS_ECDHE_PSK_WITH_CHACHA20_POLY1305_SHA256";
$opensslciphername["PSK-AES256-GCM-SHA384"] = "TLS_PSK_WITH_AES_256_GCM_SHA384";
$opensslciphername["PSK-CHACHA20-POLY1305"] = "TLS_PSK_WITH_CHACHA20_POLY1305_SHA256";
$opensslciphername["RSA-PSK-AES128-GCM-SHA256"] = "TLS_RSA_PSK_WITH_AES_128_GCM_SHA256";
$opensslciphername["DHE-PSK-AES128-GCM-SHA256"] = "TLS_DHE_PSK_WITH_AES_128_GCM_SHA256";
$opensslciphername["PSK-AES128-GCM-SHA256"] = "TLS_PSK_WITH_AES_128_GCM_SHA256";
$opensslciphername["RSA-PSK-AES256-CBC-SHA384"] = "TLS_RSA_PSK_WITH_AES_256_CBC_SHA384";
$opensslciphername["DHE-PSK-AES256-CBC-SHA384"] = "TLS_DHE_PSK_WITH_AES_256_CBC_SHA384";
$opensslciphername["RSA-PSK-AES256-CBC-SHA"] = "TLS_RSA_PSK_WITH_AES_256_CBC_SHA";
$opensslciphername["DHE-PSK-AES256-CBC-SHA"] = "TLS_DHE_PSK_WITH_AES_256_CBC_SHA";
$opensslciphername["PSK-AES256-CBC-SHA384"] = "TLS_PSK_WITH_AES_256_CBC_SHA384";
$opensslciphername["RSA-PSK-AES128-CBC-SHA256"] = "TLS_RSA_PSK_WITH_AES_128_CBC_SHA256";
$opensslciphername["DHE-PSK-AES128-CBC-SHA256"] = "TLS_DHE_PSK_WITH_AES_128_CBC_SHA256";
$opensslciphername["RSA-PSK-AES128-CBC-SHA"] = "TLS_RSA_PSK_WITH_AES_128_CBC_SHA";
$opensslciphername["DHE-PSK-AES128-CBC-SHA"] = "TLS_DHE_PSK_WITH_AES_128_CBC_SHA";
$opensslciphername["PSK-AES128-CBC-SHA256"] = "TLS_PSK_WITH_AES_128_CBC_SHA256";

$browsers_name["Chrome"] = 1;
$browsers_name["IE"] = 2;
$browsers_name["Safari"] = 3;
$browsers_name["Firefox"] = 4;
$browsers_name["Android"] = 5;
$browsers_name["Opera"] = 6;
$browsers_name["Blackberry"] = 7;
$browsers_name["UCBrowser"] = 8;
$browsers_name["Silk"] = 9;
$browsers_name["Nokia"] = 10;
$browsers_name["NetFront"] = 11;
$browsers_name["QQ"] = 12;
$browsers_name["Maxthon"] = 13;
$browsers_name["SogouExplorer"] = 14;
$browsers_name["Spotify"] = 15;
$browsers_name["Bot"] = 16;
$browsers_name["AppleBot"] = 17;
$browsers_name["BaiduBot"] = 18;
$browsers_name["BingBot"] = 19;
$browsers_name["DuckDuckGoBot"] = 20;
$browsers_name["FacebookBot"] = 21;
$browsers_name["GoogleBot"] = 22;
$browsers_name["LinkedInBot"] = 23;
$browsers_name["MsnBot"] = 24;
$browsers_name["PingdomBot"] = 25;
$browsers_name["TwitterBot"] = 26;
$browsers_name["YandexBot"] = 27;
$browsers_name["YahooBot"] = 28;
$browsers_name["Burp"] = 29;
$browsers_name["Guzzle"] = 30;

$osplatform["WindowsPhone"] = 1;
$osplatform["Windows"] = 2;
$osplatform["MacOSX"] = 3;
$osplatform["iOS"] = 4;
$osplatform["Android"] = 5;
$osplatform["Blackberry"] = 6;
$osplatform["ChromeOS"] = 7;
$osplatform["Kindle"] = 8;
$osplatform["WebOS"] = 9;
$osplatform["Linux"] = 10;
$osplatform["Playstation"] = 11;
$osplatform["Xbox"] = 12;
$osplatform["Nintendo"] = 13;
$osplatform["Bot"] = 14;

$osname["Windows"] = 1;
$osname["Mac"] = 2;
$osname["Linux"] = 3;
$osname["iPad"] = 4;
$osname["iPhone"] = 5;
$osname["iPod"] = 6;
$osname["Blackberry"] = 7;
$osname["WindowsPhone"] = 8;
$osname["Playstation"] = 9;
$osname["Xbox"] = 10;
$osname["Nintendo"] = 11;
$osname["Bot"] = 12;

$devicetype["Computer"] = 1;
$devicetype["Tablet"] = 2;
$devicetype["Phone"] = 3;
$devicetype["Console"] = 4;
$devicetype["Wearable"] = 5;
$devicetype["TV"] = 6;
        
class TLSmitm
{ 
    private $apacheParser;
    private $detector;
    private $mitm;
    
    public function __construct($detector)
    {
        $this->apacheParser = null;
        $this->detector = $detector;
        $this->mitmlist = [];
    }
    
    public function getMitmList()
    {
        return $this->mitmlist;
    }
    
    public function start()
    {
        $this->ApacheParser = new \laf\Logs\Apache;
        $this->ApacheParser->setLogFile("/var/log/apache2/ssl_request_log");
        $this->ApacheParser->setRegex("/^\[(.*)\] ([^ ]*) ([^ ]*) ___ ([^ ]*) ___ '([^ ]*)' /");
        // [24/Jul/2019:19:03:13 +0000] ::1 TLSv1.2 ___ CIPHER ___ 'CIPHERSUITE' 

        $timeNow = new \DateTime("now", new \DateTimeZone("Europe/Paris"));
        $timeNow->sub(new \DateInterval("PT1S"));
        
        $this->ApacheParser->setStartDate($timeNow);
        //$this->ApacheParser->setTimeZone(new \DateTimeZone("+0000"));
        $this->ApacheParser->setDetectionFunction("laf\Detection\TLSmitm::detection");
    }
    
    public function finish()
    {
        $timeNow = new \DateTime("now", new \DateTimeZone("Europe/Paris"));
        $this->ApacheParser->setFinishDate($timeNow);
        $this->ApacheParser->parseLogs($this->detector);
    }
    
    public function loadMitmFromFile($file)
    {
        if(!file_exists($file)) {
            echo "file = '$file' doesn't exist\n";
            return;
        }
        
        $fp = fopen($file, "r");
        if(!$fp) {
            echo "fail to open file = '$file'\n";
            return;
        }

        while(!feof($fp)) {
            $line = fgets($fp);
            #<browser_name>:<browser_version>:<os_platform>:<os_name>:<os_version>:<device_type>:<quirks>|<tls_version>:<cipher_suites>:<extension_names>:<curves>:<ec_point_fmts>:<http_headers>:<quirks>|<mitm_name>:<mitm_type>:<mitm_grade>
            preg_match("/([^|]*)\|([^|]*)\|([^|]*)\|([^|]*)\|([^|]*)\|([^|]*)\|([^|]*)\|([^|]*)\|([^|]*)\|([^|]*)\|([^|]*)\|([^|]*)\|([^|]*)\|([^|]*)\|([^|]*)\|([^|]*)\|([^|]*)/", $line, $matches);
        
            if(isset($matches[9]) && isset($matches[15]) && isset($matches[16]) && isset($matches[17])) {
                $this->mitmlist[] = array($matches[9], $matches[15], $matches[16], $matches[17]);
            }
        }
        
        fclose($fp);
    }
    
    public static function getType($id) 
    {
        $mitmtype["Antivirus"] = 1;
        $mitmtype["FakeBrowser"] = 2;
        $mitmtype["Malware"] = 3;
        $mitmtype["Parental"] = 4;
        $mitmtype["Proxy"] = 5;

        foreach($mitmtype as $key => $value) {
            if($id == $value)
                return $key;
        }
    
        return '';
    }
    
    public static function getGrade($id) 
    {
        $mitmgrade["A"] = 1;
        $mitmgrade["B"] = 2;
        $mitmgrade["C"] = 3;
        $mitmgrade["F"] = 4;
        
        foreach($mitmgrade as $key => $value) {
            if($id == $value)
                return $key;
        }
    
        return '';
    }
    
    public static function detection($detector, $time, $ip, $ciphersuite)
    {   
        $lookforcipherlist = "";
        $cipherlist = explode(":", $ciphersuite);
        
        foreach($cipherlist as $cipher) {
            if(isset($opensslciphername[$cipher])) {
                $iananame = $opensslciphername[$cipher];
                $lookforcipherlist .= "$iananame:";
                /*
                $tlscipherid = $ciphers[$iana];
                $lookforcipherlist .= sprintf("%x", $tlscipherid);
                $lookforcipherlist .= ":";
                */
            }
        }
        
        $lookfornbcipherlist = count($cipherlist);
        $lookforcipherlist = substr($lookforcipherlist, 0, -1);
        $lookforcipherlistexploded = explode(":", $lookforcipherlist);

        foreach($detector->getTLSmitm()->getMitmList() as $mitm) {
        
            $explodedcipherlistmitm = explode(':', $mitm[0]);
            if(count($explodedcipherlistmitm) == $lookfornbcipherlist) {
                
                $notfound = 0;
                    
                foreach($lookforcipherlistexploded as $cipherid) {
                    if(!in_array($cipherid, $explodedcipherlistmitm)) {
                        $notfound ++;
                    }
                }
                    
                if(($notfound / $lookfornbcipherlist) < 0.3) {
                    $alarm = new \laf\Alarming\Alarm("MITM", $mitm[1]." detected: MITM type ".TLSmitm::getType($mitm[2])." grade ".TLSmitm::getGrade($mitm[3]), 0, $time);
                    $detector->addAlarm($alarm);
                    break;
                }
            }
        }
    }
}

